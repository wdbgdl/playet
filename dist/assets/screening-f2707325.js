import{G as ve,S as fe,U as he,I as B,V as ye,J as ge,W as me,H as _e,j as n,X as ke,Y as Se,Z as we,L as Y,K as xe,$ as De,n as Ce,M as Ie,_ as be,r as p,u as J,a0 as G,D as W,w as j,g as E,o as y,c as S,i as o,k as q,F as M,q as Q,t as Z,a1 as V,a2 as U,a3 as F,l as _,N as Te,y as H,x as P,E as $e,a4 as X,a5 as Pe,a6 as Fe,a7 as w,a8 as Le,a9 as Ae,z as Be,A as Ee,aa as Oe}from"./index-a264a3fc.js";import{_ as ze}from"./SelectionPopup-facb0ecc.js";const[Ne,h]=ve("action-sheet"),qe=fe({},he,{title:String,round:B,actions:ye(),closeIcon:ge("cross"),closeable:B,cancelText:String,description:String,closeOnPopstate:B,closeOnClickAction:Boolean,safeAreaInsetBottom:B}),Me=[...me,"round","closeOnPopstate","safeAreaInsetBottom"];var Ve=_e({name:Ne,props:qe,emits:["select","cancel","update:show"],setup(s,{slots:r,emit:x}){const g=t=>x("update:show",t),u=()=>{g(!1),x("cancel")},$=()=>{if(s.title)return n("div",{class:h("header")},[s.title,s.closeable&&n(Y,{name:s.closeIcon,class:[h("close"),xe],onClick:u},null)])},D=()=>{if(r.cancel||s.cancelText)return[n("div",{class:h("gap")},null),n("button",{type:"button",class:h("cancel"),onClick:u},[r.cancel?r.cancel():s.cancelText])]},k=(t,C)=>t.loading?n(De,{class:h("loading-icon")},null):r.action?r.action({action:t,index:C}):[n("span",{class:h("name")},[t.name]),t.subname&&n("div",{class:h("subname")},[t.subname])],v=(t,C)=>{const{color:L,loading:A,callback:m,disabled:I,className:i}=t,O=()=>{I||A||(m&&m(t),s.closeOnClickAction&&g(!1),Ce(()=>x("select",t,C)))};return n("button",{type:"button",style:{color:L},class:[h("item",{loading:A,disabled:I}),i],onClick:O},[k(t,C)])},d=()=>{if(s.description||r.description){const t=r.description?r.description():s.description;return n("div",{class:h("description")},[t])}};return()=>n(we,ke({class:h(),position:"bottom","onUpdate:show":g},Se(s,Me)),{default:()=>{var t;return[$(),d(),n("div",{class:h("content")},[s.actions.map(v),(t=r.default)==null?void 0:t.call(r)]),D()]}})}});const He=Ie(Ve);const Ke=s=>(Be("data-v-9e1cf583"),s=s(),Ee(),s),Re={class:"content"},je=["onClick","src"],Qe=["onClick","muted","src"],Ue=["onClick"],Xe={class:"right-info"},Ye={class:"video-text"},Je={class:"title"},Ge=["src"],We={key:0},Ze={key:1,style:{color:"gray"}},ea={key:2},aa=Ke(()=>o("div",{class:"chatSplit"},null,-1)),ta={key:0,class:"workBottom"},la={__name:"Videocom",props:{playsData:{type:Object,required:!0},workFlag:{type:Boolean,default:!1}},emits:["goLink"],setup(s,{emit:r}){const x=r;let g=p(!1),u=p(!0),$=p(!0),D=p(-1),k=p(!1),v=p(!1),d=p(0),t=p("");p(!1),p({});let C=p(0),L=p(0),A=p(50);p(!1);let{proxy:m}=Oe(),I=J(),i=G(),{musicData:O,epsPopupVisible:K,currentsubEpsId:ee}=W(i),c=s;j(()=>ee.value,e=>{m.$refs.swipeRef.swipeTo(e)},{deep:!0}),j(()=>c.playsData.isPlay,e=>{e!==null&&(e===!1?m.$refs.videos[d.value].pause():e===!0&&m.$refs.videos[d.value].play())}),E(()=>c.playsData.collectionFlag!==!0&&c.playsData.flag!==!0||localStorage.getItem("Qy")===null);let ae=E(()=>localStorage.getItem("Qy")!==null),te=E(()=>{let e=[];return i.playsData.videos.forEach((l,f)=>{f==d.value&&l.chat.forEach(N=>e.push(N))}),e});E(()=>i.playsData.videos[d.value].chat.length);function z(e){if(v.value===!0||k.value===!0)v.value=!1,k.value=!1;else{let l=null;clearTimeout(l),g.value=!g.value,l=setTimeout(()=>{g.value===!0?u.value===!0?(m.$refs.videos[e].play(),u.value=!1):(m.$refs.videos[e].pause(),u.value=!0):(u.value=!1,$.value=!1,c.playsData.videos[d.value].likeFlag===!1&&(w({icon:"like",message:"已点赞"}),i.$patch(()=>{c.playsData.videos[d.value].likeFlag=!0}))),g.value=!1},300)}}const le=()=>{var e;K.value=!K.value,x("goLink",((e=I.currentRoute.value.query)==null?void 0:e.id)||1)};function se(e){C.value=e.touches[0].clientX,L.value=e.touches[0].clientY}function oe(e){let l=e.changedTouches[0].clientX-C.value,f=e.changedTouches[0].clientY-L.value;Math.abs(l)>A.value&&Math.abs(l)>Math.abs(f)&&(l>=0?(console.log("右滑"),u.value=!1,i.playsData.navIndex!==0?i.$patch(()=>{i.playsData.navIndex--}):w("前面没有咯~")):(console.log("左滑"),u.value=!1,i.playsData.navIndex!==3?i.playsData.navIndex++:I.push({path:"/authorHome",query:{dataObj:JSON.stringify(c.playsData)}})))}function ne(e){m.$refs.videos[e.index].pause(),u.value=!1}function ce(e){m.$refs.videos[e.index].play(),D.value=e.index,d.value=e.index,i.$patch(()=>{c.playsData.backHomeIndex=e.index})}function ie(){c.workFlag?I.go(-1):I.push({path:"/authorHome",query:{dataObj:JSON.stringify(c.playsData)}})}function re(e){u.value=!1,localStorage.getItem("Qy")!==null?c.playsData.videos[e].collectionFlag?(i.$patch(()=>{c.playsData.videos[e].collectionFlag=!1,c.playsData.videos[e].collTotal--}),w("已取消")):(i.$patch(()=>{c.playsData.videos[e].collectionFlag=!0,c.playsData.videos[e].collTotal++}),w("已收藏")):w("登录后才可以收藏哦~")}const R=()=>{if(localStorage.getItem("Qy")!==null)if(t.value!==""){let{name:e,img:l}=O.value,f={name:e,chatImg:l,chatLikeShow:!1,chatTextShow:!1,chatText:t.value};i.addChatData(f,d.value),w("评论成功"),t.value=""}else w("内容不可为空哦~");else t.value="",w("登录后才可以评论哦~")},ue=e=>{localStorage.getItem("Qy")!==null?e.chatLikeShow=!e.chatLikeShow:w("登录后才可以点赞评论哦~")};return(e,l)=>{const f=Y,N=Le,de=Ae,pe=He;return y(),S(M,null,[o("div",Re,[n(de,{ref:"swipeRef","initial-swipe":_(c).playsData.swipeIndex,onDragEnd:ce,onDragStart:ne,"show-indicators":!1,style:{height:"100%"},vertical:"","lazy-render":!0},{default:q(()=>[(y(!0),S(M,null,Q(_(c).playsData.videos,(a,b)=>(y(),Z(N,{key:b},{default:q(()=>[o("div",{class:"videos",onTouchstart:se,onTouchend:oe},[V(o("img",{onClick:F(T=>z(b),["stop"]),src:a.bgImg,class:"videos",alt:""},null,8,je),[[U,a.imgFlag]]),V(o("video",{onClick:F(T=>z(b),["stop"]),muted:_($),preload:"metadata",ref_for:!0,ref:"videos",id:"videos",class:Te(a.sizeFlag?"videosize":"videos"),src:a.videoUrl,loop:""}," 当前设备不支持该视频播放 ",10,Qe),[[U,a.imgFlag!==!0]])],32),_(u)?(y(),S("div",{key:0,onClick:T=>z(b),class:"conPlay"},[n(f,{name:"play",color:"#fff",size:"50"})],8,Ue)):H("",!0),o("div",Xe,[o("div",null,[n(f,{onClick:F(T=>re(b),["stop"]),name:"star",size:"30",color:a.collectionFlag&&_(ae)?"#ffb701":"#fff"},null,8,["onClick","color"]),o("p",null,P(a.collTotal),1)])]),o("div",Ye,[o("div",Je,[o("h4",{onClick:l[0]||(l[0]=F(T=>ie(),["stop"]))},"@"+P(a.name),1),o("i",null,P(a.time),1)]),o("p",null,P(a.text),1)]),o("div",{onClick:l[1]||(l[1]=F(T=>le(),["stop"])),class:"seleted"}," 选集 ")]),_:2},1024))),128))]),_:1},8,["initial-swipe"])]),n(pe,{show:_(v),"onUpdate:show":l[2]||(l[2]=a=>X(v)?v.value=a:v=a),overlay:!1,title:"评论"},{default:q(()=>[(y(!0),S(M,null,Q(_(te),(a,b)=>(y(),S("div",{class:"chatContent",key:b},[o("img",{src:a.chatImg,alt:""},null,8,Ge),o("div",null,[o("i",null,P(a.name),1),a.flag||s.playsData.flag?(y(),S("span",We,"作者")):H("",!0),a.chatTextShow?(y(),S("p",Ze,"！[该评论已被隐藏]")):(y(),S("p",ea,P(a.chatText),1))]),o("div",null,[n(f,{onClick:T=>ue(a),name:a.chatLikeShow?"like":"like-o",size:"16",color:a.chatLikeShow?"#f9476f":""},null,8,["onClick","name","color"]),$e("    "),n(f,{onClick:T=>a.chatTextShow=!a.chatTextShow,name:a.chatTextShow?"eye":"closed-eye",size:"16"},null,8,["onClick","name"])])]))),128)),aa]),_:1},8,["show"]),n(ze,{currentPlayData:_(c).playsData},null,8,["currentPlayData"]),s.workFlag?(y(),S("div",ta,[V(o("input",{type:"text",onKeyup:l[3]||(l[3]=Fe(a=>R(),["enter"])),placeholder:"善语结善缘，恶言伤人心","onUpdate:modelValue":l[4]||(l[4]=a=>X(t)?t.value=a:t=a)},null,544),[[Pe,_(t),void 0,{trim:!0}]]),n(f,{name:"guide-o",onClick:l[5]||(l[5]=a=>R()),color:"#fff"})])):H("",!0)],64)}}},sa=be(la,[["__scopeId","data-v-9e1cf583"]]),ca={__name:"screening",setup(s){let r=G(),{playsData:x,playsSubData:g}=W(r),u=J();function $(D){var v;let k=(v=x.value.videos)==null?void 0:v.find(d=>(d==null?void 0:d.id)==D);g.value.videos=k==null?void 0:k.children,u.push({path:"/pages_square/dramaSubset/dramaSubset",query:{id:D}})}return(D,k)=>(y(),Z(sa,{playsData:_(x),type:"switchPlay",onGoLink:$},null,8,["playsData"]))}};export{ca as default};
